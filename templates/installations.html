{% extends "base.html" %} {% block content %}
<h2>Velg installasjon</h2>

{% if error %}
<p class="error">{{ error }}</p>
{% endif %}

<form method="post" action="/export">
    <input type="hidden" name="installation_id" value="{{ installations[0].Id if installations else '' }}" />
    <input type="hidden" name="installation_name" value="{{ installations[0].Name if installations else '' }}" />

    {% for installation in installations %}
    <div>
        <input type="radio" name="installation_id" value="{{ installation.Id }}" id="inst_{{ installation.Id }}" />
        <label for="inst_{{ installation.Id }}">{{ installation.Name }} ({{ installation.Address }})</label>
    </div>
    {% endfor %}

    <h3>Tidsperiode</h3>
    <div>
        <label for="year">År:</label><br />
        <input type="number" id="year" name="year" min="2000" max="2100" value="{{ year if year else '' }}" required />
    </div>
    <div>
        <label for="month">Måned:</label><br />
        <select id="month" name="month" required>
            <option value="">Velg måned</option>
            <option value="1">Januar</option>
            <option value="2">Februar</option>
            <option value="3">Mars</option>
            <option value="4">April</option>
            <option value="5">Mai</option>
            <option value="6">Juni</option>
            <option value="7">Juli</option>
            <option value="8">August</option>
            <option value="9">September</option>
            <option value="10">Oktober</option>
            <option value="11">November</option>
            <option value="12">Desember</option>
        </select>
    </div>

    <h3>Faktura detaljer</h3>
    <div>
        <label for="nok_per_kwh">kr per kWh:</label><br />
        <input type="number" step="0.01" id="nok_per_kwh" name="nok_per_kwh" min="0" value="0.00" required />
    </div>
    <br />
    <button type="submit">Eksporter bruk</button>
    <a href="/logout" style="margin-left: 10px">Logg out</a>
</form>

<script>
    // Select first installation automatically if only one exists
    document.addEventListener("DOMContentLoaded", function () {
        const radios = document.querySelectorAll(
            'input[name="installation_id"]',
        );
        if (radios.length === 1) {
            radios[0].checked = true;
        }
    });
</script>
{% endblock %}